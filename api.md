<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [WebSocket and Rx Streams Interface](#websocket-and-rx-streams-interface)
    -   [connectToSpdzProxyPromise](#connecttospdzproxypromise)
    -   [connectToSpdzPartyPromise](#connecttospdzpartypromise)
    -   [sendSecretInputsPromise](#sendsecretinputspromise)
    -   [sendClearInputsPromise](#sendclearinputspromise)
    -   [disconnectFromSpdzPartyPromise](#disconnectfromspdzpartypromise)
-   [REST client interface](#rest-client-interface)
    -   [connectToSPDZ](#connecttospdz)
    -   [checkProxies](#checkproxies)
    -   [allProxiesConnected](#allproxiesconnected)
    -   [consumeDataFromProxies](#consumedatafromproxies)
    -   [sendInputsWithShares](#sendinputswithshares)
    -   [retrieveRegIntsAsHexString](#retrieveregintsashexstring)
    -   [disconnectFromSPDZ](#disconnectfromspdz)
    -   [NoContentError](#nocontenterror)
    -   [ProxyStatusCodes](#proxystatuscodes)
-   [Bootstrap interface](#bootstrap-interface)
    -   [bootstrapConnectSetup](#bootstrapconnectsetup)
    -   [runSpdzProgram](#runspdzprogram)
-   [Crypto functions](#crypto-functions)
    -   [createClientPublicKey](#createclientpublickey)
    -   [setDHKeyPair](#setdhkeypair)
    -   [createEncryptionKey](#createencryptionkey)
    -   [decrypt](#decrypt)
-   [Utility functions](#utility-functions)
    -   [binaryToIntArray](#binarytointarray)
    -   [initFixedPointParams](#initfixedpointparams)
    -   [logger](#logger)

## WebSocket and Rx Streams Interface

Client interface to connect to all SPDZ Proxies using web sockets. Returns [bacon.js](https://github.com/baconjs/bacon.js) reactive streams.


### connectToSpdzProxyPromise

Connect to the web socket servers run by a set of SPDZ Proxies, establishing a stateful web socket for each proxy.
There is no attempt to connect to the runnning SPDZ process at this stage. See connectToSpdzPartyPromise.

**Parameters**

-   `spdzProxyList` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)>** the list of SPDZ Proxies to connect to.
    -   `spdzProxyList.url` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** the URL of the proxy.
    -   `spdzProxyList.encryptionKey` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** the pregenerated encryption key between this client and this SPDZ engine.
                        If undefined then assume SPDZ message not encrypted.
-   `webSocketConfig` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** socket.io config setting to override the default web socket connection config.
-   `timeoutMs` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** maximum time in millisecs to wait for a connection to all proxies before timing out. (optional, default `2100`)

**Examples**

```javascript
Connect to 2 proxies and subscribe to the returned reactive streams:

const spdzProxyClient = require('spdz-client-lib/dist/socket_api')

spdzProxyClient.connectToSpdzProxyPromise(
   [{url: 'http://spdzproxy1', encryptionKey: 'a1b2c3'},
    {url: 'http://spdzproxy1', encryptionKey: 'a1b2c3'}], {})
.then(streams => {
  const [connectedStatusStream, spdzResultStream, spdzErrorStream] = streams
  connectedStatusStream.onValue(status => {
    console.log(
      `SPDZ combined connected status ${status.eventType} connected ${status.status}.`
    )
  })
  spdzResultStream.onValue(valueList => {
    console.log('SPDZ outputs message.', valueList)
  })
  spdzErrorStream.onError(err => {
    console.log('SPDZ err message.', err)
  })
})
.catch(err => {
  logger.warn(`Unable to connect to SPDZ proxies. ${err.message}`)
})
```

Returns **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;EventStream>** if promise resolves, which is an Array containing Bacon.js reactive streams.

Returns **EventStream** connectionStream - stream of combined proxy and spdz connection events containing an object {eventType, status, msg}. EventType is either 'Proxy connect' or 'SPDZ connect', status is true for connected to all proxies, false otherwise, msg contains an array of values from each individual proxy connection.

Returns **EventStream** spdzResultStream - stream of combined result events containing an Array<Number>. Here each proxy is expected to supply the same results and only one copy is returned. Does not currently support share of a result from each proxy.

Returns **EventStream** spdzErrorStream - stream of error events containing the error message.

### connectToSpdzPartyPromise

Establish the TCP connection between the SPDZ Proxy and the SPDZ Engine for all previously established web socket connections (see connectToSpdzProxyPromise).
Will timeout if connection not made within time limit.  See SPDZ instructions listen, acceptclientconnection and regint.read_client_public_key.

**Parameters**

-   `clientPublicKey` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** the client public key, required by the SPDZ engines to generate the encryption key if the SPDZ MPC program is using encryption. (optional, default `undefined`)
-   `timeoutMs` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** maximum time in millisecs to wait for all SPDZ engines to establish connections. (optional, default `3100`)

**Examples**

```javascript
Connect to spdz engines:

const spdzProxyClient = require('spdz-client-lib/dist/socket_api')

spdzProxyClient.connectToSpdzPartyPromise('b979d4508acd90156353dee3f7de36608432eeba7b37bd363ca9427d4b684748')
.then(() => {
  // send input or whatever next steps are needed
})
.catch(err => {
  logger.warn(`Unable to connect to SPDZ engines. ${err.message}`)
})
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** which resolves to an empty function on success. The connectionStream created in connectToSpdzProxyPromise will report a SPDZ connect event.

### sendSecretInputsPromise

Send an array of integers to all SPDZ Proxies in secret shared form (SPDZ sint). A connection to all SPDZ Engines with connectToSpdzPartyPromise must have been successfully run. The supplied inputs will not be sent until the expected number of correlated random triples have been received from the SPDZ Engines (this happens in the background).

**Parameters**

-   `inputList` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)>** containing array of all integers or all fixed point numbers to send to SPDZ as input.
    Inputs are suitable for SPDZ sint or sfix format and are secret shared amongst the SPDZ Engines.

**Examples**

```javascript
Sending inputs to be secret shared amoungst spdz engines:

const spdzProxyClient = require('spdz-client-lib/dist/socket_api')

spdzProxyClient.sendSecretInputsPromise([1234, 555, 6543])
.then(() => {
  // first part of send has been successful,
  // however the inputs may not yet have been dispatched to the SPDZ engines.
})
.catch(err => {
  logger.warn(`Unable to send secret shared input to SPDZ engines. ${err.message}`)
})
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** which resolves to an empty function. If the send immediately fails, for example if no longer connected to all the SPDZ Engines, the returned promise rejects. However, for delayed errors such as an incompatible number of shares being provided for the inputs to be sent, then the spdzErrorStream created in connectToSpdzProxyPromise will report an error.

### sendClearInputsPromise

Send an array of integers to all SPDZ Proxies, no secret sharing. A connection to all SPDZ Engines with connectToSpdzPartyPromise must have been successfully run.

**Parameters**

-   `inputList` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)>** containing an array of all integers or all fixed point numbers to send to SPDZ as input.
    Inputs are suitable for SPDZ regint (integers only) or cint or cfix format (integer or fixed point).
-   `spdzType` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** values are either 'int32' (default) (SPDZ regint) or 'modp' (SPDZ cint or cfix). (optional, default `'int32'`)

**Examples**

```javascript
Sending clear inputs to all spdz engines:

const spdzProxyClient = require('spdz-client-lib/dist/socket_api')

spdzProxyClient.sendClearInputsPromise([12.34, 0.142, 654.3])
.then(() => {
  // send has been successful
})
.catch(err => {
  logger.warn(`Unable to send inputs to SPDZ engines. ${err.message}`)
})
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** which resolves to an empty function or rejects if fails to send.

### disconnectFromSpdzPartyPromise

Disconnect from the SPDZ Engines closing the TCP connection between the SPDZ Proxy and the SPDZ Engine. It will reject if the disconnect does not complete within the timeout.
If the SPDZ Engine process ends and disconnects first the connectionStream created in connectToSpdzProxyPromise will report a SPDZ connect event with status of false.

**Parameters**

-   `timeoutMs` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** maximum time in millisecs to wait for a disconnection from all proxies before timing out. (optional, default `2100`)

**Examples**

```javascript
Disconnecting from all spdz engines:

const spdzProxyClient = require('spdz-client-lib/dist/socket_api')

spdzProxyClient.disconnectFromSpdzPartyPromise(3000)
.then(() => {
  console.log('Disconnected from all SPDZ Engines.')
})
.catch(err => {
  logger.warn(`Unable to disconnect from SPDZ engines. ${err.message}`)
})
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** which resolves to an empty function or rejects if unable to disconnect.

## REST client interface

Client interface to connect to all SPDZ Proxies using a REST interface.

These functions use `fetch` which may require a polyfill to be installed by the calling application.

Browser applications are suggested to use `require('whatwg-fetch')` which is included by default with create-react-app. Native fetch may be available in the browser.

Node applications are suggested to use `require('isomorphic-fetch')` which pulls in `node-fetch`. Node needs the polyfill.

A promise polyfill is already included.


### connectToSPDZ

Run the connection setup to establish the TCP connection between the SPDZ Proxy and the SPDZ Engine for all SPDZ proxy servers.
Returns the results for all connections in an array. Use allProxiesConnected to check result. Note that this is a stateful request as the clientId is stored and used to identify which TCP connection to use for subsequent requests. Calling again will replace the clientId.
See SPDZ instructions listen, acceptclientconnection and regint.read_client_public_key.

**Parameters**

-   `spdzProxyUrlList` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>** array of urls, one per SPDZ proxy
-   `spdzApiRoot` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** api path e.g. /spdzapi
-   `clientId` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** optional client id, assumes same id used for all proxies. If not supplied a client id will be generated per proxy. (optional, default `undefined`)
-   `clientPublicKey` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** optional 64 byte hex string representing the client public key and used to encrypt traffic if set. (optional, default `undefined`)

**Examples**

```javascript
Connect to spdz engines:

import { connectToSPDZ } from 'spdz-client-lib/dist/rest_api'

connectToSPDZ(['http://spdzproxy0', 'http://spdzproxy1'], '/spdzapi', 
               'b979d4508acd90156353dee3f7de36608432eeba7b37bd363ca9427d4b684748',
               'b979d4508acd90156353dee3f7de36608432eeba7b37bd363ca9427d4b684748')
.then(values => {
  if (allProxiesConnected(values)) {
    console.log('All proxies connected') 
  }
  else {
    console.log('Unable to connect to all Spdz Proxy Servers', values)
  }
})
```

Returns **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)>** result\[] - a promise which resolves to a list of objects once all connection setup requests are finished.

Returns **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** result.id - position in spdzProxyUrlList

Returns **ProxyStatusCode** result.status - connection result for this proxy

Returns **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** result.generatedClientId - the client id used by the SPDZ Proxy to identify the connection.

### checkProxies

Run check on status of connections for all spdz proxy servers for this client.

**Parameters**

-   `spdzProxyUrlList` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>** array of urls, one per SPDZ proxy
-   `spdzApiRoot` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** api path e.g. /spdzapi

**Examples**

```javascript
Check status of connections:

import { checkProxies } from 'spdz-client-lib/dist/rest_api'

checkProxies(['http://spdzproxy0', 'http://spdzproxy1'])
.then(values => {
    console.log('Proxy connection status is ', values) 
})
```

Returns **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)>** result\[] - a promise which resolves to a list of objects once all status check requests are finished.

Returns **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** result.id - position in spdzProxyUrlList

Returns **ProxyStatusCode** result.status - connection result for this proxy

### allProxiesConnected

Convenience function to extract overall connection status from list of SPDZ Proxy connected status.

**Parameters**

-   `spdzConnectionStatusList` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)>** Array of connection status objects.
    -   `spdzConnectionStatusList.status` **ProxyStatusCode** The proxy status.

**Examples**

```javascript
Check status of connections:

import { allProxiesConnected } from 'spdz-client-lib/dist/rest_api'

const connected = allProxiesConnected([{status: 2},{status: 2}])
console.log("Connected status ", connected)
```

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** true if all connected (ProxyStatusCodes.Connected), otherwise false.

### consumeDataFromProxies

Consume binary data sent by SPDZ engines to the SPDZ proxy buffers. This is a low level function which does not parse the SPDZ binary data. See higher level functions, for example retrieveRegIntsAsHexString or sendInputsWithShares.

**Parameters**

-   `spdzProxyList` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)>** Array of objects, one per SPDZ Proxy
    -   `spdzProxyList.url` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** URL of proxy
    -   `spdzProxyList.encryptionKey` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** optional precomputed encryption key, to decrypt SPDZ message.
-   `spdzApiRoot` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** path for spdz api
-   `encrypted` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** if true decrypt payload with encryptionKey
-   `waitTimeoutMs` **Integer** time to wait in ms for data to become available. (optional, default `0`)

**Examples**

```javascript
Consume data:

import { consumeDataFromProxies } from 'spdz-client-lib/dist/rest_api'

consumeDataFromProxies([{url: http://spdzproxy0, encryptionKey: 'abc'},
                                          {url: http://spdzproxy0, encryptionKey: 'abc'}],
                                         '/spdzapi', true, waitTimeoutMs=2000)
.then(buffers => {
  // process buffers, extract out values and compare or combine across proxies.
 })
.catch(err => {
  if (err instanceof NoContentError) {
    console.log('No data available')
  } else {
    console.log(`Error consuming data from SPDZ proxies. ${err.message}`)
  }
})
```

Returns **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)>** Promise which is thenable and resolves to a list of Uint8Array buffers containing decrypted SPDZ output. Array follows the order of spdzProxyUrlList. Rejects with a NoContentError if no data is available to consume, this can be used to detect not ready yet and retry.

### sendInputsWithShares

Send an array of integers to all SPDZ Proxies in secret shared form (SPDZ sint). This first retrieves the expected number of correlated random triples from the SPDZ Engines.
See SPDZ instruction sint.receive_from_client.

**Parameters**

-   `inputList` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;Integer>** an Array of integer values to be secret shared.
-   `encrypted` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** are the correlated random triples encrypted, true or false. Dependant on connectToSPDZ setup.
-   `spdzProxyList` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)>** Array of objects, one per SPDZ Proxy
    -   `spdzProxyList.url` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** URL of proxy
    -   `spdzProxyList.encryptionKey` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** optional precomputed encryption key, to decrypt SPDZ message.
-   `spdzApiRoot` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** path for spdz api
-   `waitTimeoutMs` **Integer** time to wait in ms for data sent by SPDZ to become available. (optional, default `0`)

**Examples**

```javascript
Send inputs:

import { sendInputsWithShares } from 'spdz-client-lib/dist/rest_api'

sendInputsWithShares([123, 456, 777], true,
                     [{url: http://spdzproxy0, encryptionKey: 'abc'},
                      {url: http://spdzproxy0, encryptionKey: 'abc'}],
                     '/spdzapi', waitTimeoutMs=2000)
.then(() => {
  console.log('Sent inputs successfully')
 })
.catch(err => {
 console.log(`Error sending inputs. ${err.message}`)
})
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** which resolves to an empty function.

### retrieveRegIntsAsHexString

Retrieve a result given as a number of 32 bit integer (regint) values and return as a hex string. All SPDZ Engines are expected to reveal locally and return the same result.
See SPDZ instruction regint.write_to_socket.

**Parameters**

-   `spdzProxyList` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)>** Array of objects, one per SPDZ Proxy
    -   `spdzProxyList.url` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** URL of proxy
    -   `spdzProxyList.encryptionKey` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** optional precomputed encryption key, to decrypt SPDZ message.
-   `spdzApiRoot` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** path for spdz api
-   `regIntCount` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** number of regint values expecting in result
-   `encrypted` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** are the correlated random triples encrypted, true or false. Dependant on connectToSPDZ setup. (optional, default `false`)

**Examples**

```javascript
Retrieve integers as hex string:

import { retrieveRegIntsAsHexString } from 'spdz-client-lib/dist/rest_api'

retrieveRegIntsAsHexString([{url: http://spdzproxy0, encryptionKey: 'abc'},
                            {url: http://spdzproxy0, encryptionKey: 'abc'}],
                           '/spdzapi', 8, true)
.then(result => {
  console.log(`Received result ${result}.`)
 })
.catch(err => {
 console.log(`Error receiving result. ${err.message}`)
})
```

Returns **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** Promise resolves to a single result as a hex string.

### disconnectFromSPDZ

Disconnect, closing the TCP connection between the SPDZ Proxy and the SPDZ Engine.

**Parameters**

-   `spdzProxyList` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)>** Array of objects, one per SPDZ Proxy
    -   `spdzProxyList.url` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** URL of proxy
-   `spdzApiRoot` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** path for spdz api

**Examples**

```javascript
Disconnect:

import { disconnectFromSPDZ } from 'spdz-client-lib/dist/rest_api'

disconnectFromSPDZ([{url: http://spdzproxy0}, {url: http://spdzproxy0}], '/spdzapi')
.then(values => {
   console.log('Disconnect from SPDZ results', values)
})
```

Returns **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)>** result\[] - a promise which resolves to a list of objects once all disconnection requests are finished.

Returns **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** result.id - position in spdzProxyList

Returns **ProxyStatusCode** result.status - connection result for this proxy

### NoContentError

Error to represent missing data when client is requesting data from a SPDZ Proxy.

**Parameters**

-   `message` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** text

Returns **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** extended from Error.prototype

### ProxyStatusCodes

Represent possible connection states between a SPDZ Proxy and a SPDZ Engine.

**Examples**

```javascript
Codes are:

{ Disconnected: 1, Connected: 2, Failure: 3 }
```

Returns **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** statename: statevalue

## Bootstrap interface

A websocket interface to allow a client to start a SPDZ process.


### bootstrapConnectSetup

Manage web socket connection to a SPDZ proxy for a specific SPDZ server. Designed for bootstrapping SPDZ processes.

**Parameters**

-   `url` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** URL of the SPDZ Proxy.
-   `userOptions` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** socket.io config options to override defaults. (optional, default `{}`)

**Examples**

```javascript
Connect to the SPDZ Proxy to allow SPDZ processes to be started:

const spdzBootStrap = require('spdz-client-lib/dist/bootstrap_api')

spdzBootStrap.bootstrapConnectSetup('http://spdzproxy1', {})
.then(() => {
  console.log('Connected successfully')
})
.catch(err => {
  logger.warn(`Unable to connect to SPDZ proxy. ${err.message}`)
})
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** which resolves with no params if connected OK or rejects with reason.

### runSpdzProgram

Request a single SPDZ Proxy to start a SPDZ process running the requested program. 
Assumes that bootstrapConnectSetup has been run.

**Parameters**

-   `spdzProgram` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The SPDZ program to start.
-   `forceStart` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** If already running then force stop the process.

**Examples**

```javascript
Run a SPDZ program, stopping any already runnng program:

const spdzBootStrap = require('spdz-client-lib/dist/bootstrap_api')

spdzBootStrap.runSpdzProgram('monthly_trend', true)
.then(() => {
  console.log('Program monthly_trend started successfully')
})
.catch(err => {
  logger.warn(`Unable to start program monthly_trend. ${err.message}`)
})
```

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** resolves with no params if runs program or rejects with a reason.

## Crypto functions

Provide cryptographic functions to manage keys and encryption between client and SPDZ.
Note that the crypto functions use libsodium with [restricted browser support](https://github.com/jedisct1/libsodium.js).


### createClientPublicKey

Creates an X25519 (ECDH over Curve25519) key pair. Used where a client, running an application in a browser needs a key pair to secure a message interchange with a SPDZ engine.
Results are memoized to prevent a new key pair being generated once sent to the server.

**Examples**

```javascript
Generate key pair and return public key:

const crypto = require('spdz-client-lib/dist/crypto')

const publicKey = crypto.createClientPublicKey()
```

Returns **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** public key as 64 character hex string representing 32 bytes

### setDHKeyPair

Set the X25519 (ECDH over Curve25519) key pair from previously computed values.
For example where a server is acting as a client to SPDZ Engines and the public key is persisted between runs.

**Parameters**

-   `clientPublicKeyHexString` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** as 64 char hex
-   `clientPrivateKeyHexString` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** as 64 char hex

### createEncryptionKey

Derive a shared key for authenticated encryption from this client's secret key and the server public key.
Client key material is already expected to be set, otherwise it will generate a new pair with createClientPublicKey().
Shared key = hash(q || client_secretkey || server_publickey) where q is scalarmult(client_secretkey, server_publickey).

**Parameters**

-   `serverPublicKeyHexString` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** Server public key as 64 char hex string

**Examples**

```javascript
Generate encryption key:

const crypto = require('spdz-client-lib/dist/crypto')

const sessionKey = crypto.createEncryptionKey('b979d4508acd90156353dee3f7de36608432eeba7b37bd363ca9427d4b684748')
```

Returns **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** encryption key derived for session

### decrypt

Authenticated decryption of cipher text. SPDZ Engine encrypts with pre-computed shared encryption key, client decrypts.

**Parameters**

-   `encryptionKey` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** Previously generated session key between this client and the SPDZ Engine. See createEncryptionKey.
-   `cipherMessage` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** Message comprises, 16 byte mac + cipher text + 24 bytes nonce. Supports Uint8Array or hex string.

**Examples**

```javascript
Decrypt a message:

const crypto = require('spdz-client-lib/dist/crypto')

const clearBuffer = crypto.decrypt(encryption_key, cipher_msg)
```

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** clearMessage (or throws).

## Utility functions

Other functions which may be of use.


### binaryToIntArray

Convert binary output result from all SPDZ Engines into an array of 32 bit unsigned integers.
Designed for SPDZ programs which reveal and return regint results.
Validates that binary outputs are the same across all SPDZ Engines and returns int results from the first SPDZ engine.

**Parameters**

-   `byteBufferList` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)>** Array of binary data sent from SPDZ Engines.

**Examples**

```javascript
Extract out the integer results from a SPDZ program:

const { binaryToIntArray } = require('./type_mapping/binaryToArray')

const byteBufferList = [Uint8Array.from([0x1, 0x0, 0x0, 0x0, 0x2, 0x0, 0x0, 0x0]),
                        Uint8Array.from([0x1, 0x0, 0x0, 0x0, 0x2, 0x0, 0x0, 0x0])]
const intArray = binaryToIntArray(byteBufferList)
// intArray is [1, 2]
```

Returns **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)>** an array of unsigned integers, representing the results from a single SPDZ Engine.

### initFixedPointParams

Setup the fixed point parameters to match the SPDZ MPC parameters, equivalent to instruction (cfix | sfix).set_precision(f, k).
Defaults are (f,k) of (20,40).

**Parameters**

-   `f` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** integer to override default fixed point decimal bit length
-   `k` **[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** integer to override default fixed point whole bit length

### logger

A simple logging library to write to the console, which operates in nodejs or the browser.
 Set the logging level with logger.level = debug | info | warn | error, or in node using the LOG_LEVEL env variable.
 Call with logger.<level>(msg, optional args). Set the log level to reveal / suppress debug messages in the spdz-client-lib.

**Examples**

```javascript
Logging example:

const { logger } = require('../dist/utility')
logger.level = 'info'

logger.info('an info msg', var1, var2)
logger.debug('a debug msg') // Not printed to console.
```
